(function(e){String.prototype.replaceAll=function(i,k,j){if(!RegExp.prototype.isPrototypeOf(i)){return this.replace(new RegExp(i,(j?"gm":"g")),k)}else{return this.replace(i,k)}};String.prototype.startWith=function(i){if(i==null||i==""||this.length==0||i.length>this.length){return false}if(this.substr(0,i.length)==i){return true}else{return false}return true};function c(){this.data={};this.count=0;if(typeof c.prototype.get!="function"){c.prototype.put=function(j,k){if(typeof j==="object"){throw new Error("Parameter key must not be a object.")}if(this.contains(j)){var i=this.data[j];this.data[j]=k;return i}this.data[j]=k;this.count++;return k};c.prototype.putAll=function(j){if(j instanceof c){if(j.count>0){var i=this;j.each(function(k,l){i.put(k,l)})}return this}else{throw new Error("Parameter must be instance of Map.")}};c.prototype.putObject=function(l,i){if(!l){return this}for(var j in l){if((j&&l[j])&&(i||(!i&&(l.hasOwnProperty(j))))){this.put(j,l[j])}}return this};c.prototype.get=function(i){return this.data[i]};c.prototype.remove=function(j){if(this.contains(j)){var i=this.data[j];delete this.data[j];this.count--;return i}return null};c.prototype.removeAll=c.prototype.clear=function(){var i=this.count;this.data={};this.count=0;return i};c.prototype.contains=c.prototype.containsKey=function(i){return this.data.hasOwnProperty(i)};c.prototype.containsValue=function(j){for(var i in this.data){if(this.data[i]==j){return true}}return false};c.prototype.keys=function(){var i=new Array();for(var j in this.data){i.push(j)}return i};c.prototype.values=function(){var i=new Array();for(var j in this.data){i.push(this.data[j])}return i};c.prototype.toKvString=function(l,k){l=l||"&";k=k||"=";var i="";for(var j in this.data){i+=j+k+this.data[j]+l}if(this.count>0){i=i.substring(0,i.length-1)}return i};c.prototype.eachKeys=function(m){var l=0;for(var j in this.data){m.call(j,l++)}};c.prototype.eachValues=function(m){var l=0;for(var j in this.data){m.call(this.data[j],l++)}};c.prototype.each=function(n){var m=0;for(var l in this.data){var j=this.data[l];n.call({key:l,value:j},l,this.data[l],m++)}};c.prototype.size=function(){return this.count};c.prototype.getData=function(){return this.data};c.prototype.equals=function(l){if(!l instanceof c){throw new Error("parameter error.")}if(this.count==0&&l.size()==0){return true}var j=this.data,k=l.getData();for(var i in j){if(j[i]!=k[i]){return false}}for(var i in k){if(j[i]!=k[i]){return false}}return true}}return this}function h(i){this.url=i||e.location;this.map=new c();if(typeof h.prototype.setUrl!="function"){h.prototype.setUrl=function(j){this.clear();this.url=j;this.init()};h.prototype.toString=function(){var j=this.url+"?";j+=this.map.toKvString();return j};h.prototype.setParam=function(j,k){this.map.put(j,k);return this};h.prototype.setParamsMap=function(k,j){if(j){this.map.clear()}this.map.putAll(k);return this};h.prototype.getParamValue=function(j){return this.map.get(j)};h.prototype.getAllParams=function(){return this.map};h.prototype.paramEquals=function(j,k){if(f.isEmpty(j)){return false}var l=this.getParamValue(j);return l==k};h.prototype.clear=function(){this.map.clear();this.url=""};h.prototype.go=function(){e.location.href=this.toString()};h.prototype.replace=function(){e.location.replace(this.toString())};h.prototype.init=function(){if(typeof this.url==="object"&&this.url.hasOwnProperty("href")){this.url=this.url.href}var k=this.url.split("?");if(k.length==1){}else{if(k.length==2){this.url=k[0];k=k[1].split("&");for(var l=0,j=k.length;l<j;l++){var m=k[l].split("=");this.map.put(m[0],m[1])}}else{throw new Error("Bad URL format.")}}return this};h.prototype.containsKey=function(j){return this.map.contains(j)};h.prototype.containsValue=function(j){return this.map.containsValue(j)};h.prototype.containsAll=function(j,k){return this.map.get(j)===k};h.prototype.getBaseUrl=function(){return this.url}}return this.init()}function g(o,m,n,j,i,l){this.tplStr=o instanceof Array?o.join(""):o;this.data=m;this.rule=n;this.alias=j;this.limitConfig=i;this.txtOutLimit="...";this.func=false;this.scope=this;if(typeof g.prototype.init!=="function"){g.prototype.init=function(){if(j){if(this.data instanceof Array){for(var q=0,p=this.data.length;q<p;q++){this.data[q]=k(this.data[q],this.alias)}}else{this.data=k(this.data,this.alias)}}};g.prototype.setRule=function(p){this.rule=p;return this};g.prototype.setAlias=function(p){this.aliss=p;this.init();return this};g.prototype.setLimitConfig=function(p){this.limitConfig=p;return this};g.prototype.setLimitString=function(p){this.txtOutLimit=p;return this};g.prototype.setFunc=function(p){if(p&&typeof p==="function"){this.func=p;this.scope=this}if(p&&p.func&&typeof p.func==="function"){this.func=p.func;if(p.scope){this.scope=p.scope}}return this};g.prototype.html=function(){var q=new Array(),s=this;if(!s.data||!s.tplStr){throw new Error("tplString and data cannot be null.")}if(this.data instanceof Array){for(var r=0,p=s.data.length;r<p;r++){q.push(t(s.tplStr,s.data[r],s.rule))
}}else{q.push(t(s.tplStr,s.data,s.rule))}return q.join("");function t(x,v,z){if(s.func){s.func.call(s.scope,v)}if(z){for(var C in z){var B=v[C];var D=z[C];if(D!=null&&D!=undefined){var y=D[B];if(!y&&D["def"]){y=D["def"]}y?v[C]=y:""}}}var E=x;for(var u in v){var C=u;if(/^\d+/.test(u)){C="tpl_i_"+u}var w=v[u],A=new RegExp("@{"+C+"}","gm");if(s.limitConfig&&s.limitConfig[u]&&w.length>s.limitConfig[u]){w=w.substring(0,s.limitConfig[u])+s.txtOutLimit}E=E.replace(A,w)}return E}};g.prototype.update=function(p){this.data=p;this.init();return this}}this.init();return this;function k(t,s){for(var q in s){if(s[q] instanceof Array){for(var r=0,p=s[q].length;r<p;r++){t[s[q][r]]=t[q]}}else{t[s[q]]=t[q]}}return t}}function d(i,j){this.tpl=i;this.data=j;if(typeof d.prototype.html!=="function"){}}function b(){}var f={isUndefined:function(i){return i===undefined&&typeof i==="undefined"},isNull:function(i){return this.isUndefined(i)||null===i},isEmpty:function(i){if(this.isNull(i)){return true}return i===""}};var a={Global:{},Map:c,Url:h,STemplate:g,Template:d,ETemplate:b,Utils:f};if(typeof define==="function"&&define.amd){define("xxx",[],function(){return a})}else{e.xxx=a}})(window);